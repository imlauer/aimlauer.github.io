<!DOCTYPE html>
<html lang="es">





<head>
  <meta property="og:url" content="https://imlauera.github.io/reversing_simple_estructura/">
  <meta property="og:site_name" content="Imlauer">
  <meta property="og:title" content="Reversing: simple estructura en C">
  <meta property="og:description" content="#include &lt;stdio.h&gt; struct persona { char nombre[20]; int edad; char telefono[60]; }; int main(void){ struct persona persona1; printf(&#34;Tamaño de la estructura: %d\n&#34;,sizeof(persona1)); // Esto no se puede hacer. printf(&#34;Ingrese su nombre: &#34;); scanf(&#34;%s&#34;,persona1.nombre); printf(&#34;Ingrese su edad: &#34;); scanf(&#34;%d&#34;,&amp;persona1.edad); printf(&#34;Ingrese su telefono: &#34;); scanf(&#34;%s&#34;,persona1.telefono); printf(&#34;Nombre: %s, Edad: %d, Teléfono: %s\n&#34;, persona1.nombre, persona1.edad, persona1.telefono); return 0; } Codigo generado por radare (r2 executable). │ 0x00001159 55 push rbp │ 0x0000115a 4889e5 mov rbp, rsp │ 0x0000115d 4883ec60 sub rsp, 0x60 │ 0x00001161 64488b0425.. mov rax, qword fs:[0x28] │ 0x0000116a 488945f8 mov qword [canary], rax │ 0x0000116e 31c0 xor eax, eax │ 0x00001170 be54000000 mov esi, 0x54 ; &#39;T&#39; │ 0x00001175 488d058c0e.. lea rax, str.Tamao_de_la_estructura:__d_n ; 0x2008 ; &#34;Tama\u00f1o de la estructura: %d\n&#34; │ 0x0000117c 4889c7 mov rdi, rax ; const char *format │ 0x0000117f b800000000 mov eax, 0 │ 0x00001184 e8b7feffff call sym.imp.printf ; int printf(const char *format) │ 0x00001189 488d05960e.. lea rax, str.Ingrese_su_nombre: ; 0x2026 ; &#34;Ingrese su nombre: &#34; │ 0x00001190 4889c7 mov rdi, rax ; const char *format │ 0x00001193 b800000000 mov eax, 0 │ 0x00001198 e8a3feffff call sym.imp.printf ; int printf(const char *format) │ 0x0000119d 488d45a0 lea rax, [var_60h] │ 0x000011a1 4889c6 mov rsi, rax │ 0x000011a4 488d058f0e.. lea rax, [0x0000203a] ; &#34;%s&#34; │ 0x000011ab 4889c7 mov rdi, rax ; const char *format │ 0x000011ae b800000000 mov eax, 0 │ 0x000011b3 e898feffff call sym.imp.__isoc99_scanf ; int scanf(const char *format) │ 0x000011b8 488d057e0e.. lea rax, str.Ingrese_su_edad: ; 0x203d ; &#34;Ingrese su edad: &#34; │ 0x000011bf 4889c7 mov rdi, rax ; const char *format │ 0x000011c2 b800000000 mov eax, 0 │ 0x000011c7 e874feffff call sym.imp.printf ; int printf(const char *format) │ 0x000011cc 488d45a0 lea rax, [var_60h] │ 0x000011d0 4883c014 add rax, 0x14 │ 0x000011d4 4889c6 mov rsi, rax │ 0x000011d7 488d05710e.. lea rax, [0x0000204f] ; &#34;%d&#34; │ 0x000011de 4889c7 mov rdi, rax ; const char *format │ 0x000011e1 b800000000 mov eax, 0 │ 0x000011e6 e865feffff call sym.imp.__isoc99_scanf ; int scanf(const char *format) │ 0x000011eb 488d05600e.. lea rax, str.Ingrese_su_telefono: ; 0x2052 ; &#34;Ingrese su telefono: &#34; │ 0x000011f2 4889c7 mov rdi, rax ; const char *format │ 0x000011f5 b800000000 mov eax, 0 │ 0x000011fa e841feffff call sym.imp.printf ; int printf(const char *format) │ 0x000011ff 488d45a0 lea rax, [var_60h] │ 0x00001203 4883c018 add rax, 0x18 ; &#34;`\x10&#34; │ 0x00001207 4889c6 mov rsi, rax │ 0x0000120a 488d05290e.. lea rax, [0x0000203a] ; &#34;%s&#34; │ 0x00001211 4889c7 mov rdi, rax ; const char *format │ 0x00001214 b800000000 mov eax, 0 │ 0x00001219 e832feffff call sym.imp.__isoc99_scanf ; int scanf(const char *format) │ 0x0000121e 8b55b4 mov edx, dword [var_4ch] │ 0x00001221 488d45a0 lea rax, [var_60h] │ 0x00001225 488d4818 lea rcx, [rax &#43; 0x18] │ 0x00001229 488d45a0 lea rax, [var_60h] │ 0x0000122d 4889c6 mov rsi, rax │ 0x00001230 488d05310e.. lea rax, str.Nombre:__s__Edad:__d__Telfono:__s_n ; 0x2068 ; &#34;Nombre: %s, Edad: %d, Tel\u00e9fono: %s\n&#34; │ 0x00001237 4889c7 mov rdi, rax ; const char *format │ 0x0000123a b800000000 mov eax, 0 │ 0x0000123f e8fcfdffff call sym.imp.printf ; int printf(const char *format) │ 0x00001244 b800000000 mov eax, 0 │ 0x00001249 488b55f8 mov rdx, qword [canary] │ 0x0000124d 64482b1425.. sub rdx, qword fs:[0x28] │ ┌─&lt; 0x00001256 7405 je 0x125d │ │ 0x00001258 e8d3fdffff call sym.imp.__stack_chk_fail ; void __stack_chk_fail(void) │ │ ; CODE XREF from sub.main_1159 @ 0x1256(x) │ └─&gt; 0x0000125d c9 leave └ 0x0000125e c3 ret Explicación Todos los registros que empiezan con r toman los primeros 64 bits, los que empiezan con e los primeros 32 bits, y si no tienen ninguno hacen referencia a los primeros 16 bits. Ejemplo: rax(64 bits), eax(32 bits), AX(16 bits).">
  <meta property="og:locale" content="es_es">
  <meta property="og:type" content="article">
    <meta property="article:published_time" content="2025-01-04T19:18:02-03:00">
    <meta property="article:modified_time" content="2025-01-04T19:18:02-03:00">
    <meta property="article:tag" content="Estructura">

  
  <meta itemprop="name" content="Reversing: simple estructura en C">
  <meta itemprop="description" content="#include &lt;stdio.h&gt; struct persona { char nombre[20]; int edad; char telefono[60]; }; int main(void){ struct persona persona1; printf(&#34;Tamaño de la estructura: %d\n&#34;,sizeof(persona1)); // Esto no se puede hacer. printf(&#34;Ingrese su nombre: &#34;); scanf(&#34;%s&#34;,persona1.nombre); printf(&#34;Ingrese su edad: &#34;); scanf(&#34;%d&#34;,&amp;persona1.edad); printf(&#34;Ingrese su telefono: &#34;); scanf(&#34;%s&#34;,persona1.telefono); printf(&#34;Nombre: %s, Edad: %d, Teléfono: %s\n&#34;, persona1.nombre, persona1.edad, persona1.telefono); return 0; } Codigo generado por radare (r2 executable). │ 0x00001159 55 push rbp │ 0x0000115a 4889e5 mov rbp, rsp │ 0x0000115d 4883ec60 sub rsp, 0x60 │ 0x00001161 64488b0425.. mov rax, qword fs:[0x28] │ 0x0000116a 488945f8 mov qword [canary], rax │ 0x0000116e 31c0 xor eax, eax │ 0x00001170 be54000000 mov esi, 0x54 ; &#39;T&#39; │ 0x00001175 488d058c0e.. lea rax, str.Tamao_de_la_estructura:__d_n ; 0x2008 ; &#34;Tama\u00f1o de la estructura: %d\n&#34; │ 0x0000117c 4889c7 mov rdi, rax ; const char *format │ 0x0000117f b800000000 mov eax, 0 │ 0x00001184 e8b7feffff call sym.imp.printf ; int printf(const char *format) │ 0x00001189 488d05960e.. lea rax, str.Ingrese_su_nombre: ; 0x2026 ; &#34;Ingrese su nombre: &#34; │ 0x00001190 4889c7 mov rdi, rax ; const char *format │ 0x00001193 b800000000 mov eax, 0 │ 0x00001198 e8a3feffff call sym.imp.printf ; int printf(const char *format) │ 0x0000119d 488d45a0 lea rax, [var_60h] │ 0x000011a1 4889c6 mov rsi, rax │ 0x000011a4 488d058f0e.. lea rax, [0x0000203a] ; &#34;%s&#34; │ 0x000011ab 4889c7 mov rdi, rax ; const char *format │ 0x000011ae b800000000 mov eax, 0 │ 0x000011b3 e898feffff call sym.imp.__isoc99_scanf ; int scanf(const char *format) │ 0x000011b8 488d057e0e.. lea rax, str.Ingrese_su_edad: ; 0x203d ; &#34;Ingrese su edad: &#34; │ 0x000011bf 4889c7 mov rdi, rax ; const char *format │ 0x000011c2 b800000000 mov eax, 0 │ 0x000011c7 e874feffff call sym.imp.printf ; int printf(const char *format) │ 0x000011cc 488d45a0 lea rax, [var_60h] │ 0x000011d0 4883c014 add rax, 0x14 │ 0x000011d4 4889c6 mov rsi, rax │ 0x000011d7 488d05710e.. lea rax, [0x0000204f] ; &#34;%d&#34; │ 0x000011de 4889c7 mov rdi, rax ; const char *format │ 0x000011e1 b800000000 mov eax, 0 │ 0x000011e6 e865feffff call sym.imp.__isoc99_scanf ; int scanf(const char *format) │ 0x000011eb 488d05600e.. lea rax, str.Ingrese_su_telefono: ; 0x2052 ; &#34;Ingrese su telefono: &#34; │ 0x000011f2 4889c7 mov rdi, rax ; const char *format │ 0x000011f5 b800000000 mov eax, 0 │ 0x000011fa e841feffff call sym.imp.printf ; int printf(const char *format) │ 0x000011ff 488d45a0 lea rax, [var_60h] │ 0x00001203 4883c018 add rax, 0x18 ; &#34;`\x10&#34; │ 0x00001207 4889c6 mov rsi, rax │ 0x0000120a 488d05290e.. lea rax, [0x0000203a] ; &#34;%s&#34; │ 0x00001211 4889c7 mov rdi, rax ; const char *format │ 0x00001214 b800000000 mov eax, 0 │ 0x00001219 e832feffff call sym.imp.__isoc99_scanf ; int scanf(const char *format) │ 0x0000121e 8b55b4 mov edx, dword [var_4ch] │ 0x00001221 488d45a0 lea rax, [var_60h] │ 0x00001225 488d4818 lea rcx, [rax &#43; 0x18] │ 0x00001229 488d45a0 lea rax, [var_60h] │ 0x0000122d 4889c6 mov rsi, rax │ 0x00001230 488d05310e.. lea rax, str.Nombre:__s__Edad:__d__Telfono:__s_n ; 0x2068 ; &#34;Nombre: %s, Edad: %d, Tel\u00e9fono: %s\n&#34; │ 0x00001237 4889c7 mov rdi, rax ; const char *format │ 0x0000123a b800000000 mov eax, 0 │ 0x0000123f e8fcfdffff call sym.imp.printf ; int printf(const char *format) │ 0x00001244 b800000000 mov eax, 0 │ 0x00001249 488b55f8 mov rdx, qword [canary] │ 0x0000124d 64482b1425.. sub rdx, qword fs:[0x28] │ ┌─&lt; 0x00001256 7405 je 0x125d │ │ 0x00001258 e8d3fdffff call sym.imp.__stack_chk_fail ; void __stack_chk_fail(void) │ │ ; CODE XREF from sub.main_1159 @ 0x1256(x) │ └─&gt; 0x0000125d c9 leave └ 0x0000125e c3 ret Explicación Todos los registros que empiezan con r toman los primeros 64 bits, los que empiezan con e los primeros 32 bits, y si no tienen ninguno hacen referencia a los primeros 16 bits. Ejemplo: rax(64 bits), eax(32 bits), AX(16 bits).">
  <meta itemprop="datePublished" content="2025-01-04T19:18:02-03:00">
  <meta itemprop="dateModified" content="2025-01-04T19:18:02-03:00">
  <meta itemprop="wordCount" content="1218">
  <meta itemprop="keywords" content="Estructura">
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Reversing: simple estructura en C">
  <meta name="twitter:description" content="#include &lt;stdio.h&gt; struct persona { char nombre[20]; int edad; char telefono[60]; }; int main(void){ struct persona persona1; printf(&#34;Tamaño de la estructura: %d\n&#34;,sizeof(persona1)); // Esto no se puede hacer. printf(&#34;Ingrese su nombre: &#34;); scanf(&#34;%s&#34;,persona1.nombre); printf(&#34;Ingrese su edad: &#34;); scanf(&#34;%d&#34;,&amp;persona1.edad); printf(&#34;Ingrese su telefono: &#34;); scanf(&#34;%s&#34;,persona1.telefono); printf(&#34;Nombre: %s, Edad: %d, Teléfono: %s\n&#34;, persona1.nombre, persona1.edad, persona1.telefono); return 0; } Codigo generado por radare (r2 executable). │ 0x00001159 55 push rbp │ 0x0000115a 4889e5 mov rbp, rsp │ 0x0000115d 4883ec60 sub rsp, 0x60 │ 0x00001161 64488b0425.. mov rax, qword fs:[0x28] │ 0x0000116a 488945f8 mov qword [canary], rax │ 0x0000116e 31c0 xor eax, eax │ 0x00001170 be54000000 mov esi, 0x54 ; &#39;T&#39; │ 0x00001175 488d058c0e.. lea rax, str.Tamao_de_la_estructura:__d_n ; 0x2008 ; &#34;Tama\u00f1o de la estructura: %d\n&#34; │ 0x0000117c 4889c7 mov rdi, rax ; const char *format │ 0x0000117f b800000000 mov eax, 0 │ 0x00001184 e8b7feffff call sym.imp.printf ; int printf(const char *format) │ 0x00001189 488d05960e.. lea rax, str.Ingrese_su_nombre: ; 0x2026 ; &#34;Ingrese su nombre: &#34; │ 0x00001190 4889c7 mov rdi, rax ; const char *format │ 0x00001193 b800000000 mov eax, 0 │ 0x00001198 e8a3feffff call sym.imp.printf ; int printf(const char *format) │ 0x0000119d 488d45a0 lea rax, [var_60h] │ 0x000011a1 4889c6 mov rsi, rax │ 0x000011a4 488d058f0e.. lea rax, [0x0000203a] ; &#34;%s&#34; │ 0x000011ab 4889c7 mov rdi, rax ; const char *format │ 0x000011ae b800000000 mov eax, 0 │ 0x000011b3 e898feffff call sym.imp.__isoc99_scanf ; int scanf(const char *format) │ 0x000011b8 488d057e0e.. lea rax, str.Ingrese_su_edad: ; 0x203d ; &#34;Ingrese su edad: &#34; │ 0x000011bf 4889c7 mov rdi, rax ; const char *format │ 0x000011c2 b800000000 mov eax, 0 │ 0x000011c7 e874feffff call sym.imp.printf ; int printf(const char *format) │ 0x000011cc 488d45a0 lea rax, [var_60h] │ 0x000011d0 4883c014 add rax, 0x14 │ 0x000011d4 4889c6 mov rsi, rax │ 0x000011d7 488d05710e.. lea rax, [0x0000204f] ; &#34;%d&#34; │ 0x000011de 4889c7 mov rdi, rax ; const char *format │ 0x000011e1 b800000000 mov eax, 0 │ 0x000011e6 e865feffff call sym.imp.__isoc99_scanf ; int scanf(const char *format) │ 0x000011eb 488d05600e.. lea rax, str.Ingrese_su_telefono: ; 0x2052 ; &#34;Ingrese su telefono: &#34; │ 0x000011f2 4889c7 mov rdi, rax ; const char *format │ 0x000011f5 b800000000 mov eax, 0 │ 0x000011fa e841feffff call sym.imp.printf ; int printf(const char *format) │ 0x000011ff 488d45a0 lea rax, [var_60h] │ 0x00001203 4883c018 add rax, 0x18 ; &#34;`\x10&#34; │ 0x00001207 4889c6 mov rsi, rax │ 0x0000120a 488d05290e.. lea rax, [0x0000203a] ; &#34;%s&#34; │ 0x00001211 4889c7 mov rdi, rax ; const char *format │ 0x00001214 b800000000 mov eax, 0 │ 0x00001219 e832feffff call sym.imp.__isoc99_scanf ; int scanf(const char *format) │ 0x0000121e 8b55b4 mov edx, dword [var_4ch] │ 0x00001221 488d45a0 lea rax, [var_60h] │ 0x00001225 488d4818 lea rcx, [rax &#43; 0x18] │ 0x00001229 488d45a0 lea rax, [var_60h] │ 0x0000122d 4889c6 mov rsi, rax │ 0x00001230 488d05310e.. lea rax, str.Nombre:__s__Edad:__d__Telfono:__s_n ; 0x2068 ; &#34;Nombre: %s, Edad: %d, Tel\u00e9fono: %s\n&#34; │ 0x00001237 4889c7 mov rdi, rax ; const char *format │ 0x0000123a b800000000 mov eax, 0 │ 0x0000123f e8fcfdffff call sym.imp.printf ; int printf(const char *format) │ 0x00001244 b800000000 mov eax, 0 │ 0x00001249 488b55f8 mov rdx, qword [canary] │ 0x0000124d 64482b1425.. sub rdx, qword fs:[0x28] │ ┌─&lt; 0x00001256 7405 je 0x125d │ │ 0x00001258 e8d3fdffff call sym.imp.__stack_chk_fail ; void __stack_chk_fail(void) │ │ ; CODE XREF from sub.main_1159 @ 0x1256(x) │ └─&gt; 0x0000125d c9 leave └ 0x0000125e c3 ret Explicación Todos los registros que empiezan con r toman los primeros 64 bits, los que empiezan con e los primeros 32 bits, y si no tienen ninguno hacen referencia a los primeros 16 bits. Ejemplo: rax(64 bits), eax(32 bits), AX(16 bits).">

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    
    Reversing: simple estructura en C
    
  </title>
  <link rel="stylesheet" href='https://imlauera.github.io/css/site.min.css'>
  <link rel="canonical" href="https://imlauera.github.io/reversing_simple_estructura/">
  <link rel="alternate" type="application/rss&#43;xml" href="https://imlauera.github.io/index.xml" title="Imlauer">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer">
  <meta name="author" content="Imlauer.">
  <meta name="description" content="#include &lt;stdio.h&gt;

struct persona {
        char nombre[20];
        int edad;
        char telefono[60];
};

int main(void){
        struct persona persona1;
        printf(&#34;Tamaño de la estructura: %d\n&#34;,sizeof(persona1));
        // Esto no se puede hacer.
        printf(&#34;Ingrese su nombre: &#34;);
        scanf(&#34;%s&#34;,persona1.nombre);
        printf(&#34;Ingrese su edad: &#34;);
        scanf(&#34;%d&#34;,&amp;persona1.edad);
        printf(&#34;Ingrese su telefono: &#34;);
        scanf(&#34;%s&#34;,persona1.telefono);

        printf(&#34;Nombre: %s, Edad: %d, Teléfono: %s\n&#34;, persona1.nombre, persona1.edad, persona1.telefono);
        return 0;
}

Codigo generado por radare (r2 executable).
│           0x00001159      55             push rbp
│           0x0000115a      4889e5         mov rbp, rsp
│           0x0000115d      4883ec60       sub rsp, 0x60
│           0x00001161      64488b0425..   mov rax, qword fs:[0x28]
│           0x0000116a      488945f8       mov qword [canary], rax
│           0x0000116e      31c0           xor eax, eax
│           0x00001170      be54000000     mov esi, 0x54               ; &#39;T&#39;
│           0x00001175      488d058c0e..   lea rax, str.Tamao_de_la_estructura:__d_n ; 0x2008 ; &#34;Tama\u00f1o de la estructura: %d\n&#34;
│           0x0000117c      4889c7         mov rdi, rax                ; const char *format
│           0x0000117f      b800000000     mov eax, 0
│           0x00001184      e8b7feffff     call sym.imp.printf         ; int printf(const char *format)
│           0x00001189      488d05960e..   lea rax, str.Ingrese_su_nombre: ; 0x2026 ; &#34;Ingrese su nombre: &#34;
│           0x00001190      4889c7         mov rdi, rax                ; const char *format
│           0x00001193      b800000000     mov eax, 0
│           0x00001198      e8a3feffff     call sym.imp.printf         ; int printf(const char *format)
│           0x0000119d      488d45a0       lea rax, [var_60h]
│           0x000011a1      4889c6         mov rsi, rax
│           0x000011a4      488d058f0e..   lea rax, [0x0000203a]       ; &#34;%s&#34;
│           0x000011ab      4889c7         mov rdi, rax                ; const char *format
│           0x000011ae      b800000000     mov eax, 0
│           0x000011b3      e898feffff     call sym.imp.__isoc99_scanf ; int scanf(const char *format)
│           0x000011b8      488d057e0e..   lea rax, str.Ingrese_su_edad: ; 0x203d ; &#34;Ingrese su edad: &#34;
│           0x000011bf      4889c7         mov rdi, rax                ; const char *format
│           0x000011c2      b800000000     mov eax, 0
│           0x000011c7      e874feffff     call sym.imp.printf         ; int printf(const char *format)
│           0x000011cc      488d45a0       lea rax, [var_60h]
│           0x000011d0      4883c014       add rax, 0x14
│           0x000011d4      4889c6         mov rsi, rax
│           0x000011d7      488d05710e..   lea rax, [0x0000204f]       ; &#34;%d&#34;
│           0x000011de      4889c7         mov rdi, rax                ; const char *format
│           0x000011e1      b800000000     mov eax, 0
│           0x000011e6      e865feffff     call sym.imp.__isoc99_scanf ; int scanf(const char *format)
│           0x000011eb      488d05600e..   lea rax, str.Ingrese_su_telefono: ; 0x2052 ; &#34;Ingrese su telefono: &#34;
│           0x000011f2      4889c7         mov rdi, rax                ; const char *format
│           0x000011f5      b800000000     mov eax, 0
│           0x000011fa      e841feffff     call sym.imp.printf         ; int printf(const char *format)
│           0x000011ff      488d45a0       lea rax, [var_60h]
│           0x00001203      4883c018       add rax, 0x18               ; &#34;`\x10&#34;
│           0x00001207      4889c6         mov rsi, rax
│           0x0000120a      488d05290e..   lea rax, [0x0000203a]       ; &#34;%s&#34;
│           0x00001211      4889c7         mov rdi, rax                ; const char *format
│           0x00001214      b800000000     mov eax, 0
│           0x00001219      e832feffff     call sym.imp.__isoc99_scanf ; int scanf(const char *format)
│           0x0000121e      8b55b4         mov edx, dword [var_4ch]
│           0x00001221      488d45a0       lea rax, [var_60h]
│           0x00001225      488d4818       lea rcx, [rax &#43; 0x18]
│           0x00001229      488d45a0       lea rax, [var_60h]
│           0x0000122d      4889c6         mov rsi, rax
│           0x00001230      488d05310e..   lea rax, str.Nombre:__s__Edad:__d__Telfono:__s_n ; 0x2068 ; &#34;Nombre: %s, Edad: %d, Tel\u00e9fono: %s\n&#34;
│           0x00001237      4889c7         mov rdi, rax                ; const char *format
│           0x0000123a      b800000000     mov eax, 0
│           0x0000123f      e8fcfdffff     call sym.imp.printf         ; int printf(const char *format)
│           0x00001244      b800000000     mov eax, 0
│           0x00001249      488b55f8       mov rdx, qword [canary]
│           0x0000124d      64482b1425..   sub rdx, qword fs:[0x28]
│       ┌─&lt; 0x00001256      7405           je 0x125d
│       │   0x00001258      e8d3fdffff     call sym.imp.__stack_chk_fail ; void __stack_chk_fail(void)
│       │   ; CODE XREF from sub.main_1159 @ 0x1256(x)
│       └─&gt; 0x0000125d      c9             leave
└           0x0000125e      c3             ret
Explicación
Todos los registros que empiezan con r toman los primeros 64 bits, los que empiezan con e los primeros 32 bits, y si no tienen ninguno hacen referencia a los primeros 16 bits. Ejemplo: rax(64 bits), eax(32 bits), AX(16 bits).">
</head>
<body><nav class="navbar is-transparent " role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="https://imlauera.github.io/">
      <figure class="image">
        <img alt="" class="is-rounded" src="/img/memememe.jpg">
      </figure>
    </a>
    <a class="navbar-item" href="https://imlauera.github.io/">
      Imlauer
    </a>
    <a class="navbar-item" href="/acerca/">
      Acerca de Mi
    </a>
  </div>
  
  
</nav>

  <section>
    <section class='hero is-small is-link is-fullwidth'>
      <div class="hero-body">
<div class="container">
  <h1 class="title">
    Reversing: simple estructura en C
  </h1>
  <h2 class="subtitle">
    <time datetime='2025-01-04T19:18:02-03:00'>
      January 04, 2025
    </time>
    
    <br>
    
    
    
    <a class="tag is-info" href="https://imlauera.github.io/tags/estructura/">Estructura</a>
    
    
    
  </h2>
</div>

      </div>
    </section>
    <section class="section">
      <div class="container">
<div class="content is-medium">
  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> persona {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> nombre[<span style="color:#ae81ff">20</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> edad;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> telefono[<span style="color:#ae81ff">60</span>];
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">struct</span> persona persona1;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Tamaño de la estructura: %d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,<span style="color:#66d9ef">sizeof</span>(persona1));
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Esto no se puede hacer.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Ingrese su nombre: &#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%s&#34;</span>,persona1.nombre);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Ingrese su edad: &#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%d&#34;</span>,<span style="color:#f92672">&amp;</span>persona1.edad);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Ingrese su telefono: &#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%s&#34;</span>,persona1.telefono);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Nombre: %s, Edad: %d, Teléfono: %s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, persona1.nombre, persona1.edad, persona1.telefono);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h4 id="codigo-generado-por-radare-r2-executable">Codigo generado por radare (r2 executable).</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001159</span>      <span style="color:#ae81ff">55</span>             <span style="color:#66d9ef">push</span> <span style="color:#66d9ef">rbp</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000115a</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">e5</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rbp</span>, <span style="color:#66d9ef">rsp</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000115d</span>      <span style="color:#ae81ff">4883</span><span style="color:#66d9ef">ec60</span>       <span style="color:#66d9ef">sub</span> <span style="color:#66d9ef">rsp</span>, <span style="color:#ae81ff">0x60</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001161</span>      <span style="color:#ae81ff">64488</span><span style="color:#66d9ef">b0425..</span>   <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rax</span>, <span style="color:#66d9ef">qword</span> <span style="color:#66d9ef">fs</span>:[<span style="color:#ae81ff">0x28</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000116a</span>      <span style="color:#ae81ff">488945</span><span style="color:#66d9ef">f8</span>       <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">qword</span> [<span style="color:#66d9ef">canary</span>], <span style="color:#66d9ef">rax</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000116e</span>      <span style="color:#ae81ff">31</span><span style="color:#66d9ef">c0</span>           <span style="color:#66d9ef">xor</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001170</span>      <span style="color:#66d9ef">be54000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">esi</span>, <span style="color:#ae81ff">0x54</span>               <span style="color:#75715e">; &#39;T&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001175</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d058c0e..</span>   <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, <span style="color:#66d9ef">str.Tamao_de_la_estructura</span>:<span style="color:#66d9ef">__d_n</span> <span style="color:#75715e">; 0x2008 ; &#34;Tama\u00f1o de la estructura: %d\n&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000117c</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c7</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rdi</span>, <span style="color:#66d9ef">rax</span>                <span style="color:#75715e">; const char *format
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000117f</span>      <span style="color:#66d9ef">b800000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001184</span>      <span style="color:#66d9ef">e8b7feffff</span>     <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.imp.printf</span>         <span style="color:#75715e">; int printf(const char *format)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001189</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d05960e..</span>   <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, <span style="color:#66d9ef">str.Ingrese_su_nombre</span>: <span style="color:#75715e">; 0x2026 ; &#34;Ingrese su nombre: &#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001190</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c7</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rdi</span>, <span style="color:#66d9ef">rax</span>                <span style="color:#75715e">; const char *format
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001193</span>      <span style="color:#66d9ef">b800000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001198</span>      <span style="color:#66d9ef">e8a3feffff</span>     <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.imp.printf</span>         <span style="color:#75715e">; int printf(const char *format)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000119d</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d45a0</span>       <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, [<span style="color:#66d9ef">var_60h</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011a1</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c6</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rsi</span>, <span style="color:#66d9ef">rax</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011a4</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d058f0e..</span>   <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, [<span style="color:#ae81ff">0x0000203a</span>]       <span style="color:#75715e">; &#34;%s&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011ab</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c7</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rdi</span>, <span style="color:#66d9ef">rax</span>                <span style="color:#75715e">; const char *format
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011ae</span>      <span style="color:#66d9ef">b800000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011b3</span>      <span style="color:#66d9ef">e898feffff</span>     <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.imp.__isoc99_scanf</span> <span style="color:#75715e">; int scanf(const char *format)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011b8</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d057e0e..</span>   <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, <span style="color:#66d9ef">str.Ingrese_su_edad</span>: <span style="color:#75715e">; 0x203d ; &#34;Ingrese su edad: &#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011bf</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c7</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rdi</span>, <span style="color:#66d9ef">rax</span>                <span style="color:#75715e">; const char *format
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011c2</span>      <span style="color:#66d9ef">b800000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011c7</span>      <span style="color:#66d9ef">e874feffff</span>     <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.imp.printf</span>         <span style="color:#75715e">; int printf(const char *format)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011cc</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d45a0</span>       <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, [<span style="color:#66d9ef">var_60h</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011d0</span>      <span style="color:#ae81ff">4883</span><span style="color:#66d9ef">c014</span>       <span style="color:#66d9ef">add</span> <span style="color:#66d9ef">rax</span>, <span style="color:#ae81ff">0x14</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011d4</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c6</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rsi</span>, <span style="color:#66d9ef">rax</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011d7</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d05710e..</span>   <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, [<span style="color:#ae81ff">0x0000204f</span>]       <span style="color:#75715e">; &#34;%d&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011de</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c7</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rdi</span>, <span style="color:#66d9ef">rax</span>                <span style="color:#75715e">; const char *format
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011e1</span>      <span style="color:#66d9ef">b800000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011e6</span>      <span style="color:#66d9ef">e865feffff</span>     <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.imp.__isoc99_scanf</span> <span style="color:#75715e">; int scanf(const char *format)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011eb</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d05600e..</span>   <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, <span style="color:#66d9ef">str.Ingrese_su_telefono</span>: <span style="color:#75715e">; 0x2052 ; &#34;Ingrese su telefono: &#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011f2</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c7</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rdi</span>, <span style="color:#66d9ef">rax</span>                <span style="color:#75715e">; const char *format
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011f5</span>      <span style="color:#66d9ef">b800000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011fa</span>      <span style="color:#66d9ef">e841feffff</span>     <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.imp.printf</span>         <span style="color:#75715e">; int printf(const char *format)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011ff</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d45a0</span>       <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, [<span style="color:#66d9ef">var_60h</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001203</span>      <span style="color:#ae81ff">4883</span><span style="color:#66d9ef">c018</span>       <span style="color:#66d9ef">add</span> <span style="color:#66d9ef">rax</span>, <span style="color:#ae81ff">0x18</span>               <span style="color:#75715e">; &#34;`\x10&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001207</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c6</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rsi</span>, <span style="color:#66d9ef">rax</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000120a</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d05290e..</span>   <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, [<span style="color:#ae81ff">0x0000203a</span>]       <span style="color:#75715e">; &#34;%s&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001211</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c7</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rdi</span>, <span style="color:#66d9ef">rax</span>                <span style="color:#75715e">; const char *format
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001214</span>      <span style="color:#66d9ef">b800000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001219</span>      <span style="color:#66d9ef">e832feffff</span>     <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.imp.__isoc99_scanf</span> <span style="color:#75715e">; int scanf(const char *format)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000121e</span>      <span style="color:#ae81ff">8</span><span style="color:#66d9ef">b55b4</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4ch</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001221</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d45a0</span>       <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, [<span style="color:#66d9ef">var_60h</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001225</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d4818</span>       <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rcx</span>, [<span style="color:#66d9ef">rax</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x18</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001229</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d45a0</span>       <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, [<span style="color:#66d9ef">var_60h</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000122d</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c6</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rsi</span>, <span style="color:#66d9ef">rax</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001230</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d05310e..</span>   <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, <span style="color:#66d9ef">str.Nombre</span>:<span style="color:#66d9ef">__s__Edad</span>:<span style="color:#66d9ef">__d__Telfono</span>:<span style="color:#66d9ef">__s_n</span> <span style="color:#75715e">; 0x2068 ; &#34;Nombre: %s, Edad: %d, Tel\u00e9fono: %s\n&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001237</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c7</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rdi</span>, <span style="color:#66d9ef">rax</span>                <span style="color:#75715e">; const char *format
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000123a</span>      <span style="color:#66d9ef">b800000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000123f</span>      <span style="color:#66d9ef">e8fcfdffff</span>     <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.imp.printf</span>         <span style="color:#75715e">; int printf(const char *format)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001244</span>      <span style="color:#66d9ef">b800000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001249</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">b55f8</span>       <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rdx</span>, <span style="color:#66d9ef">qword</span> [<span style="color:#66d9ef">canary</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000124d</span>      <span style="color:#ae81ff">64482</span><span style="color:#66d9ef">b1425..</span>   <span style="color:#66d9ef">sub</span> <span style="color:#66d9ef">rdx</span>, <span style="color:#66d9ef">qword</span> <span style="color:#66d9ef">fs</span>:[<span style="color:#ae81ff">0x28</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>       <span style="color:#960050;background-color:#1e0010">┌─&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001256</span>      <span style="color:#ae81ff">7405</span>           <span style="color:#66d9ef">je</span> <span style="color:#ae81ff">0x125d</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>       <span style="color:#960050;background-color:#1e0010">│</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001258</span>      <span style="color:#66d9ef">e8d3fdffff</span>     <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.imp.__stack_chk_fail</span> <span style="color:#75715e">; void __stack_chk_fail(void)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>       <span style="color:#960050;background-color:#1e0010">│</span>   <span style="color:#75715e">; CODE XREF from sub.main_1159 @ 0x1256(x)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>       <span style="color:#960050;background-color:#1e0010">└─&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000125d</span>      <span style="color:#66d9ef">c9</span>             <span style="color:#66d9ef">leave</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">└</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000125e</span>      <span style="color:#66d9ef">c3</span>             <span style="color:#66d9ef">ret</span>
</span></span></code></pre></div><h4 id="explicación">Explicación</h4>
<p>Todos los registros que empiezan con r toman los primeros 64 bits, los que empiezan con e los primeros 32 bits, y si no tienen ninguno hacen referencia a los primeros 16 bits. Ejemplo: <code>rax(64 bits), eax(32 bits), AX(16 bits)</code>.</p>
<p>RDI: Es el primer argumento de una llamada a la función.<br>
RSI: Es el segundo argumento de una llamada a la función.<br>
R8: Es el tercero argumento de una llamada a la función.<br>
R9: Es el cuarto argumento de una llamada a la función.</p>
<p>Es decir: printf(&ldquo;Nombre: %s, Edad: %d, Teléfono: %s\n&rdquo;, persona1.nombre, persona1.edad, persona1.telefono);</p>
<h5 id="sería">Sería:</h5>
<p>RDI = &ldquo;Nombre: %s, Edad: %d, Teléfono: %s\n&rdquo;
RSI = persona1.nombre
R8 = persona1.edad
R9 = persona1.telefono</p>
<h4 id="pero-acá-como-es-una-estructura-usa-la-dirección-de-memoria-del-primer-elemento-y-le-suma-un-offset-para-llegar-al-segundo-es-decir-por-ejemplo-para-llegar-al-elemento-edad-le-suma-20-bytes-al-primer-elemento-nombre">Pero acá como es una estructura usa la dirección de memoria del primer elemento y le suma un offset para llegar al segundo. Es decir por ejemplo para llegar al elemento edad, le suma 20 bytes al primer elemento (nombre).</h4>
<p>Los demás argumentos se pasan por el stack a la pila.</p>
<p>Estas dos líneas están presentes en todos los programas, push &ldquo;empuja&rdquo; a la pila la dirección de la base de la pila.</p>
<p><code>mov</code> siempre copia del 2do argumento al 1ero.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#a6e22e">push</span> <span style="color:#66d9ef">rbp</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mov</span> <span style="color:#66d9ef">rbp</span>, <span style="color:#66d9ef">rsp</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#a6e22e">sub</span> <span style="color:#66d9ef">rsp</span>, <span style="color:#ae81ff">0x60</span>
</span></span></code></pre></div><p>Resta al puntero de la pila (stack pointer) 0x60 que son 96 bytes (la estructura tiene 20 bytes de nombre + 4 bytes de int + 60 bytes de teléfono = 84 bytes). <strong>Es como que le pide espacio para las variables.</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#a6e22e">mov</span> <span style="color:#66d9ef">rax</span>, <span style="color:#66d9ef">qword</span> <span style="color:#66d9ef">fs</span>:[<span style="color:#ae81ff">0x28</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mov</span> <span style="color:#66d9ef">qword</span> [<span style="color:#66d9ef">canary</span>], <span style="color:#66d9ef">rax</span>
</span></span></code></pre></div><p>Esto es equivalente a:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#a6e22e">mov</span> <span style="color:#66d9ef">qword</span> [<span style="color:#66d9ef">canary</span>], <span style="color:#66d9ef">qword</span> <span style="color:#66d9ef">fs</span>:[<span style="color:#ae81ff">0x28</span>]
</span></span></code></pre></div><p>Pero en ASM siempre un argumento debe ser un registro no podés tener 2 variables.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#a6e22e">xor</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mov esi, 0x54 
</span></span></code></pre></div><p>ESI es el 2do argumento pero los primeros 32 bits. En este caso carga 0x54 que son 84 bytes (el tamaño de la estructura).</p>
<p>lea rax, str.Tamao_de_la_estructura:__d_n ; 0x2008 ; &ldquo;Tama\u00f1o de la estructura: %d\n&rdquo;</p>
<p><code>lea</code> es como el <code>mov</code>. Carga en el <code>rax</code> que es un registro acumulador la cadena: &ldquo;Tamaño de la estructura: %d\n&rdquo;</p>
<p>Luego del rax lo mueve al rdi: <code>mov rdi, rax</code> como dije anteriormente hace esto porque no se puede trabajar con 2 variables, siempre hay que un registro en cada mov.</p>
<p>rdi es el primer argumento del printf luego carga 0 al eax y llama al printf:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#a6e22e">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">call</span> <span style="color:#66d9ef">sym.imp.printf</span>
</span></span></code></pre></div><p>Desde el siguiente código podemos asumir que <code>var_60h</code> es el puntero (es un puntero cuando tiene los corchetes <code>[var_60h]</code>) a la variable <strong>nombre</strong>. Lo carga al RSI es decir al segundo argumento de la función <code>scanf</code> y en el primer argumento carga: <code>&quot;%s&quot;</code>. Es deicr: <code>scanf(&quot;%s&quot;, &amp;var_60h);</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000119d</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d45a0</span>       <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, [<span style="color:#66d9ef">var_60h</span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011a1</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c6</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rsi</span>, <span style="color:#66d9ef">rax</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011a4</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d058f0e..</span>   <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, [<span style="color:#ae81ff">0x0000203a</span>]       <span style="color:#75715e">; &#34;%s&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011ab</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c7</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rdi</span>, <span style="color:#66d9ef">rax</span>                <span style="color:#75715e">; const char *format
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011ae</span>      <span style="color:#66d9ef">b800000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011b3</span>      <span style="color:#66d9ef">e898feffff</span>     <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.imp.__isoc99_scanf</span> <span style="color:#75715e">; int scanf(const char *format)
</span></span></span></code></pre></div><hr>
<p>Acá hace algo similar: carga la dirección de memoria del comienzo de la cadena de caracteres al rax, y luego lo carga al rdi (el 1er argumento de la función) y llama a printf con ese argumento:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011b8</span>      <span style="color:#ae81ff">488</span><span style="color:#66d9ef">d057e0e..</span>   <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">rax</span>, <span style="color:#66d9ef">str.Ingrese_su_edad</span>: <span style="color:#75715e">; 0x203d ; &#34;Ingrese su edad: &#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011bf</span>      <span style="color:#ae81ff">4889</span><span style="color:#66d9ef">c7</span>         <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">rdi</span>, <span style="color:#66d9ef">rax</span>                <span style="color:#75715e">; const char *format
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011c2</span>      <span style="color:#66d9ef">b800000000</span>     <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">│</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000011c7</span>      <span style="color:#66d9ef">e874feffff</span>     <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.imp.printf</span>         <span style="color:#75715e">; int printf(const char *format)
</span></span></span></code></pre></div><p>scanf: Aca vemos algo importante, le suma 0x14 (20 bytes) al puntero al primer byte de nombre para llegar a edad que es el 2do elemento de la estructura: <code>add rax, 0x14</code>, y lo carga al rsi (2do argumento de la función). Luego carga &ldquo;%d&rdquo; que está ubicado en la dirección de memoria <code>0x0000204f</code> al rax, carga 0 al eax y llama a scanf.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>│           0x000011cc      488d45a0       lea rax, <span style="color:#f92672">[</span>var_60h<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>│           0x000011d0      4883c014       add rax, 0x14
</span></span><span style="display:flex;"><span>│           0x000011d4      4889c6         mov rsi, rax
</span></span><span style="display:flex;"><span>│           0x000011d7      488d05710e..   lea rax, <span style="color:#f92672">[</span>0x0000204f<span style="color:#f92672">]</span>       ; <span style="color:#e6db74">&#34;%d&#34;</span>
</span></span><span style="display:flex;"><span>│           0x000011de      4889c7         mov rdi, rax                ; const char *format
</span></span><span style="display:flex;"><span>│           0x000011e1      b800000000     mov eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>│           0x000011e6      e865feffff     call sym.imp.__isoc99_scanf ; int scanf<span style="color:#f92672">(</span>const char *format<span style="color:#f92672">)</span>
</span></span></code></pre></div>
</div>


      </div>
    </section>
  </section><script 
src="/quiz/quizdown.js">
</script>
<script 
src="/quiz/quizdownKatex.js">
</script>
<script 
src="/quiz/quizdownHighlight.js">
</script>
<script>quizdown.register(quizdownHighlight).register(quizdownKatex).init()</script> 
<footer class="footer">
  <div class="content has-text-centered">
    
    
    <p>
      
      <a class="" href="https://imlauera.github.io/index.xml" target="_blank">
        <span>
          RSS
        </span>
      </a>
      
      | <a href="https://imlauera.github.io" target="_blank">Andres Imlauer.</a> 

      
      
    </p>
    
  </div>




<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} })
</script>
</footer>


</body>
</html>
